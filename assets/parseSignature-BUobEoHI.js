import{K as _,L as y,N as p,O as w,Q as F,R as K,V as R,X as j,Y as a,Z as $,_ as O,$ as U,a0 as Y,a1 as E,a2 as L,a3 as G,a4 as q,g as C,a5 as Q,a6 as X,a7 as Z,a8 as D,a9 as J,aa as W,ab as ee,ac as ne,ad as se,ae as m,af as te,ag as re,ah as oe,ai as ie,aj as ae,ak as ce,al as I,am as S,an as fe,ao as de,o as ue,ap as he,aq as xe}from"./index-BN_TAcui.js";function Le(e,n){if(e.length!==n.length)throw new _({expectedLength:e.length,givenLength:n.length});const t=[];for(let s=0;s<e.length;s++){const r=e[s],o=n[s];t.push(N(r,o))}return y(t)}function N(e,n,t=!1){if(e==="address"){const i=n;if(!p(i))throw new w({address:i});return F(i.toLowerCase(),{size:t?32:null})}if(e==="string")return K(n);if(e==="bytes")return n;if(e==="bool")return F(R(n),{size:t?32:1});const s=e.match(j);if(s){const[i,c,d="256"]=s,f=Number.parseInt(d,10)/8;return a(n,{size:t?32:f,signed:c==="int"})}const r=e.match($);if(r){const[i,c]=r;if(Number.parseInt(c,10)!==(n.length-2)/2)throw new O({expectedSize:Number.parseInt(c,10),givenSize:(n.length-2)/2});return F(n,{dir:"right",size:t?32:null})}const o=e.match(U);if(o&&Array.isArray(n)){const[i,c]=o,d=[];for(let f=0;f<n.length;f++)d.push(N(c,n[f],!0));return d.length===0?"0x":y(d)}throw new Y(e)}function le(e){const{authorizationList:n}=e;if(n)for(const t of n){const{chainId:s}=t,r=t.address;if(!p(r))throw new w({address:r});if(s<0)throw new E({chainId:s})}A(e)}function ge(e){const{blobVersionedHashes:n}=e;if(n){if(n.length===0)throw new Q;for(const t of n){const s=X(t),r=Z(D(t,0,1));if(s!==32)throw new J({hash:t,size:s});if(r!==W)throw new ee({hash:t,version:r})}}A(e)}function A(e){const{chainId:n,maxPriorityFeePerGas:t,maxFeePerGas:s,to:r}=e;if(n<=0)throw new E({chainId:n});if(r&&!p(r))throw new w({address:r});if(s&&s>L)throw new G({maxFeePerGas:s});if(t&&s&&t>s)throw new q({maxFeePerGas:s,maxPriorityFeePerGas:t})}function ye(e){const{chainId:n,maxPriorityFeePerGas:t,gasPrice:s,maxFeePerGas:r,to:o}=e;if(n<=0)throw new E({chainId:n});if(o&&!p(o))throw new w({address:o});if(t||r)throw new C("`maxFeePerGas`/`maxPriorityFeePerGas` is not a valid EIP-2930 Transaction attribute.");if(s&&s>L)throw new G({maxFeePerGas:s})}function me(e){const{chainId:n,maxPriorityFeePerGas:t,gasPrice:s,maxFeePerGas:r,to:o}=e;if(o&&!p(o))throw new w({address:o});if(typeof n<"u"&&n<=0)throw new E({chainId:n});if(t||r)throw new C("`maxFeePerGas`/`maxPriorityFeePerGas` is not a valid Legacy Transaction attribute.");if(s&&s>L)throw new G({maxFeePerGas:s})}function v(e){if(!e||e.length===0)return[];const n=[];for(let t=0;t<e.length;t++){const{address:s,storageKeys:r}=e[t];for(let o=0;o<r.length;o++)if(r[o].length-2!==64)throw new ne({storageKey:r[o]});if(!p(s,{strict:!1}))throw new w({address:s});n.push([s,r])}return n}function Ge(e,n){const t=se(e);return t==="eip1559"?be(e,n):t==="eip2930"?Pe(e,n):t==="eip4844"?we(e,n):t==="eip7702"?pe(e,n):ze(e,n)}function pe(e,n){const{authorizationList:t,chainId:s,gas:r,nonce:o,to:i,value:c,maxFeePerGas:d,maxPriorityFeePerGas:f,accessList:u,data:x}=e;le(e);const l=v(u),h=Te(t);return y(["0x04",m([a(s),o?a(o):"0x",f?a(f):"0x",d?a(d):"0x",r?a(r):"0x",i??"0x",c?a(c):"0x",x??"0x",l,h,...z(e,n)])])}function we(e,n){const{chainId:t,gas:s,nonce:r,to:o,value:i,maxFeePerBlobGas:c,maxFeePerGas:d,maxPriorityFeePerGas:f,accessList:u,data:x}=e;ge(e);let l=e.blobVersionedHashes,h=e.sidecars;if(e.blobs&&(typeof l>"u"||typeof h>"u")){const g=typeof e.blobs[0]=="string"?e.blobs:e.blobs.map(P=>te(P)),T=e.kzg,b=re({blobs:g,kzg:T});if(typeof l>"u"&&(l=oe({commitments:b})),typeof h>"u"){const P=ie({blobs:g,commitments:b,kzg:T});h=ae({blobs:g,commitments:b,proofs:P})}}const H=v(u),M=[a(t),r?a(r):"0x",f?a(f):"0x",d?a(d):"0x",s?a(s):"0x",o??"0x",i?a(i):"0x",x??"0x",H,c?a(c):"0x",l??[],...z(e,n)],V=[],k=[],B=[];if(h)for(let g=0;g<h.length;g++){const{blob:T,commitment:b,proof:P}=h[g];V.push(T),k.push(b),B.push(P)}return y(["0x03",h?m([M,V,k,B]):m(M)])}function be(e,n){const{chainId:t,gas:s,nonce:r,to:o,value:i,maxFeePerGas:c,maxPriorityFeePerGas:d,accessList:f,data:u}=e;A(e);const x=v(f),l=[a(t),r?a(r):"0x",d?a(d):"0x",c?a(c):"0x",s?a(s):"0x",o??"0x",i?a(i):"0x",u??"0x",x,...z(e,n)];return y(["0x02",m(l)])}function Pe(e,n){const{chainId:t,gas:s,data:r,nonce:o,to:i,value:c,accessList:d,gasPrice:f}=e;ye(e);const u=v(d),x=[a(t),o?a(o):"0x",f?a(f):"0x",s?a(s):"0x",i??"0x",c?a(c):"0x",r??"0x",u,...z(e,n)];return y(["0x01",m(x)])}function ze(e,n){const{chainId:t=0,gas:s,data:r,nonce:o,to:i,value:c,gasPrice:d}=e;me(e);let f=[o?a(o):"0x",d?a(d):"0x",s?a(s):"0x",i??"0x",c?a(c):"0x",r??"0x"];if(n){const u=(()=>{if(n.v>=35n)return(n.v-35n)/2n>0?n.v:27n+(n.v===35n?0n:1n);if(t>0)return BigInt(t*2)+BigInt(35n+n.v-27n);const h=27n+(n.v===27n?0n:1n);if(n.v!==h)throw new ce({v:n.v});return h})(),x=I(n.r),l=I(n.s);f=[...f,a(u),x==="0x00"?"0x":x,l==="0x00"?"0x":l]}else t>0&&(f=[...f,a(t),"0x","0x"]);return m(f)}function z(e,n){const t=n??e,{v:s,yParity:r}=t;if(typeof t.r>"u")return[];if(typeof t.s>"u")return[];if(typeof s>"u"&&typeof r>"u")return[];const o=I(t.r),i=I(t.s);return[typeof r=="number"?r?a(1):"0x":s===0n?"0x":s===1n?a(1):s===27n?"0x":a(1),o==="0x00"?"0x":o,i==="0x00"?"0x":i]}function Te(e){if(!e||e.length===0)return[];const n=[];for(const t of e){const{chainId:s,nonce:r,...o}=t,i=t.address;n.push([s?S(s):"0x",i,r?S(r):"0x",...z({},o)])}return n}function Ie(e){const{source:n}=e,t=new Map,s=new fe(8192),r=new Map,o=({address:i,chainId:c})=>`${i}.${c}`;return{async consume({address:i,chainId:c,client:d}){const f=o({address:i,chainId:c}),u=this.get({address:i,chainId:c,client:d});this.increment({address:i,chainId:c});const x=await u;return await n.set({address:i,chainId:c},x),s.set(f,x),x},async increment({address:i,chainId:c}){const d=o({address:i,chainId:c}),f=t.get(d)??0;t.set(d,f+1)},async get({address:i,chainId:c,client:d}){const f=o({address:i,chainId:c});let u=r.get(f);return u||(u=(async()=>{try{const l=await n.get({address:i,chainId:c,client:d}),h=s.get(f)??0;return h>0&&l<=h?h+1:(s.delete(f),l)}finally{this.reset({address:i,chainId:c})}})(),r.set(f,u)),(t.get(f)??0)+await u},reset({address:i,chainId:c}){const d=o({address:i,chainId:c});t.delete(d),r.delete(d)}}}function Ee(){return{async get(e){const{address:n,client:t}=e;return de(t,{address:n,blockTag:"pending"})},set(){}}}const Ae=Ie({source:Ee()}),ve="0x6492649264926492649264926492649264926492649264926492649264926492",He="0x0000000000000000000000000000000000000000000000000000000000000000";function Me(e){const{address:n,data:t,signature:s,to:r="hex"}=e,o=y([ue([{type:"address"},{type:"bytes"},{type:"bytes"}],[n,t,s]),ve]);return r==="hex"?o:he(o)}function Ve(e){const{r:n,s:t}=xe.Signature.fromCompact(e.slice(2,130)),s=+`0x${e.slice(130)}`,[r,o]=(()=>{if(s===0||s===1)return[void 0,s];if(s===27)return[BigInt(s),0];if(s===28)return[BigInt(s),1];throw new Error("Invalid yParityOrV value")})();return typeof r<"u"?{r:a(n,{size:32}),s:a(t,{size:32}),v:r,yParity:o}:{r:a(n,{size:32}),s:a(t,{size:32}),yParity:o}}export{A as a,ye as b,ge as c,le as d,ve as e,me as f,Ie as g,Le as h,v as i,Me as j,Ae as n,Ve as p,Ge as s,He as z};
