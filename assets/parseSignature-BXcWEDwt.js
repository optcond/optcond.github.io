import{I as _,J as g,K as m,N as b,O as F,P as K,Q as R,R as j,V as a,X as $,Y as O,Z as U,_ as Y,$ as E,a0 as G,a1 as L,a2 as q,p as S,a3 as J,a4 as Q,a5 as X,a6 as Z,a7 as D,a8 as W,a9 as ee,aa as ne,ab as te,ac as p,ad as se,ae as re,af as ie,ag as oe,ah as ae,ai as ce,aj as I,ak as B,al as fe,am as de,F as ue,an as le,ao as he,ap as xe,aq as ye}from"./index-CiyeXEvp.js";function Ae(e,n){if(e.length!==n.length)throw new _({expectedLength:e.length,givenLength:n.length});const s=[];for(let t=0;t<e.length;t++){const r=e[t],i=n[t];s.push(N(r,i))}return g(s)}function N(e,n,s=!1){if(e==="address"){const o=n;if(!m(o))throw new b({address:o});return F(o.toLowerCase(),{size:s?32:null})}if(e==="string")return K(n);if(e==="bytes")return n;if(e==="bool")return F(R(n),{size:s?32:1});const t=e.match(j);if(t){const[o,c,d="256"]=t,f=Number.parseInt(d,10)/8;return a(n,{size:s?32:f,signed:c==="int"})}const r=e.match($);if(r){const[o,c]=r;if(Number.parseInt(c,10)!==(n.length-2)/2)throw new O({expectedSize:Number.parseInt(c,10),givenSize:(n.length-2)/2});return F(n,{dir:"right",size:s?32:null})}const i=e.match(U);if(i&&Array.isArray(n)){const[o,c]=i,d=[];for(let f=0;f<n.length;f++)d.push(N(c,n[f],!0));return d.length===0?"0x":g(d)}throw new Y(e)}function ge(e){const{authorizationList:n}=e;if(n)for(const s of n){const{chainId:t}=s,r=s.address;if(!m(r))throw new b({address:r});if(t<0)throw new E({chainId:t})}A(e)}function pe(e){const{blobVersionedHashes:n}=e;if(n){if(n.length===0)throw new J;for(const s of n){const t=Q(s),r=X(Z(s,0,1));if(t!==32)throw new D({hash:s,size:t});if(r!==W)throw new ee({hash:s,version:r})}}A(e)}function A(e){const{chainId:n,maxPriorityFeePerGas:s,maxFeePerGas:t,to:r}=e;if(n<=0)throw new E({chainId:n});if(r&&!m(r))throw new b({address:r});if(t&&t>G)throw new L({maxFeePerGas:t});if(s&&t&&s>t)throw new q({maxFeePerGas:t,maxPriorityFeePerGas:s})}function me(e){const{chainId:n,maxPriorityFeePerGas:s,gasPrice:t,maxFeePerGas:r,to:i}=e;if(n<=0)throw new E({chainId:n});if(i&&!m(i))throw new b({address:i});if(s||r)throw new S("`maxFeePerGas`/`maxPriorityFeePerGas` is not a valid EIP-2930 Transaction attribute.");if(t&&t>G)throw new L({maxFeePerGas:t})}function be(e){const{chainId:n,maxPriorityFeePerGas:s,gasPrice:t,maxFeePerGas:r,to:i}=e;if(i&&!m(i))throw new b({address:i});if(typeof n<"u"&&n<=0)throw new E({chainId:n});if(s||r)throw new S("`maxFeePerGas`/`maxPriorityFeePerGas` is not a valid Legacy Transaction attribute.");if(t&&t>G)throw new L({maxFeePerGas:t})}function v(e){if(!e||e.length===0)return[];const n=[];for(let s=0;s<e.length;s++){const{address:t,storageKeys:r}=e[s];for(let i=0;i<r.length;i++)if(r[i].length-2!==64)throw new ne({storageKey:r[i]});if(!m(t,{strict:!1}))throw new b({address:t});n.push([t,r])}return n}function He(e,n){const s=te(e);return s==="eip1559"?ze(e,n):s==="eip2930"?Te(e,n):s==="eip4844"?Pe(e,n):s==="eip7702"?we(e,n):Ie(e,n)}function we(e,n){const{authorizationList:s,chainId:t,gas:r,nonce:i,to:o,value:c,maxFeePerGas:d,maxPriorityFeePerGas:f,accessList:u,data:h}=e;ge(e);const x=v(u),l=Ee(s);return g(["0x04",p([a(t),i?a(i):"0x",f?a(f):"0x",d?a(d):"0x",r?a(r):"0x",o??"0x",c?a(c):"0x",h??"0x",x,l,...z(e,n)])])}function Pe(e,n){const{chainId:s,gas:t,nonce:r,to:i,value:o,maxFeePerBlobGas:c,maxFeePerGas:d,maxPriorityFeePerGas:f,accessList:u,data:h}=e;pe(e);let x=e.blobVersionedHashes,l=e.sidecars;if(e.blobs&&(typeof x>"u"||typeof l>"u")){const y=typeof e.blobs[0]=="string"?e.blobs:e.blobs.map(P=>se(P)),T=e.kzg,w=re({blobs:y,kzg:T});if(typeof x>"u"&&(x=ie({commitments:w})),typeof l>"u"){const P=oe({blobs:y,commitments:w,kzg:T});l=ae({blobs:y,commitments:w,proofs:P})}}const H=v(u),M=[a(s),r?a(r):"0x",f?a(f):"0x",d?a(d):"0x",t?a(t):"0x",i??"0x",o?a(o):"0x",h??"0x",H,c?a(c):"0x",x??[],...z(e,n)],k=[],C=[],V=[];if(l)for(let y=0;y<l.length;y++){const{blob:T,commitment:w,proof:P}=l[y];k.push(T),C.push(w),V.push(P)}return g(["0x03",l?p([M,k,C,V]):p(M)])}function ze(e,n){const{chainId:s,gas:t,nonce:r,to:i,value:o,maxFeePerGas:c,maxPriorityFeePerGas:d,accessList:f,data:u}=e;A(e);const h=v(f),x=[a(s),r?a(r):"0x",d?a(d):"0x",c?a(c):"0x",t?a(t):"0x",i??"0x",o?a(o):"0x",u??"0x",h,...z(e,n)];return g(["0x02",p(x)])}function Te(e,n){const{chainId:s,gas:t,data:r,nonce:i,to:o,value:c,accessList:d,gasPrice:f}=e;me(e);const u=v(d),h=[a(s),i?a(i):"0x",f?a(f):"0x",t?a(t):"0x",o??"0x",c?a(c):"0x",r??"0x",u,...z(e,n)];return g(["0x01",p(h)])}function Ie(e,n){const{chainId:s=0,gas:t,data:r,nonce:i,to:o,value:c,gasPrice:d}=e;be(e);let f=[i?a(i):"0x",d?a(d):"0x",t?a(t):"0x",o??"0x",c?a(c):"0x",r??"0x"];if(n){const u=(()=>{if(n.v>=35n)return(n.v-35n)/2n>0?n.v:27n+(n.v===35n?0n:1n);if(s>0)return BigInt(s*2)+BigInt(35n+n.v-27n);const l=27n+(n.v===27n?0n:1n);if(n.v!==l)throw new ce({v:n.v});return l})(),h=I(n.r),x=I(n.s);f=[...f,a(u),h==="0x00"?"0x":h,x==="0x00"?"0x":x]}else s>0&&(f=[...f,a(s),"0x","0x"]);return p(f)}function z(e,n){const s=n??e,{v:t,yParity:r}=s;if(typeof s.r>"u")return[];if(typeof s.s>"u")return[];if(typeof t>"u"&&typeof r>"u")return[];const i=I(s.r),o=I(s.s);return[typeof r=="number"?r?a(1):"0x":t===0n?"0x":t===1n?a(1):t===27n?"0x":a(1),i==="0x00"?"0x":i,o==="0x00"?"0x":o]}function Ee(e){if(!e||e.length===0)return[];const n=[];for(const s of e){const{chainId:t,nonce:r,...i}=s,o=s.address;n.push([t?B(t):"0x",o,r?B(r):"0x",...z({},i)])}return n}function ve(e){const{source:n}=e,s=new Map,t=new fe(8192),r=new Map,i=({address:o,chainId:c})=>`${o}.${c}`;return{async consume({address:o,chainId:c,client:d}){const f=i({address:o,chainId:c}),u=this.get({address:o,chainId:c,client:d});this.increment({address:o,chainId:c});const h=await u;return await n.set({address:o,chainId:c},h),t.set(f,h),h},async increment({address:o,chainId:c}){const d=i({address:o,chainId:c}),f=s.get(d)??0;s.set(d,f+1)},async get({address:o,chainId:c,client:d}){const f=i({address:o,chainId:c});let u=r.get(f);return u||(u=(async()=>{try{const x=await n.get({address:o,chainId:c,client:d}),l=t.get(f)??0;return l>0&&x<=l?l+1:(t.delete(f),x)}finally{this.reset({address:o,chainId:c})}})(),r.set(f,u)),(s.get(f)??0)+await u},reset({address:o,chainId:c}){const d=i({address:o,chainId:c});s.delete(d),r.delete(d)}}}function Fe(){return{async get(e){const{address:n,client:s}=e;return de(s,{address:n,blockTag:"pending"})},set(){}}}const Me=ve({source:Fe()}),Ge="0x6492649264926492649264926492649264926492649264926492649264926492",ke="0x0000000000000000000000000000000000000000000000000000000000000000";function Ce(e){const{address:n,data:s,signature:t,to:r="hex"}=e,i=g([ue([{type:"address"},{type:"bytes"},{type:"bytes"}],[n,s,t]),Ge]);return r==="hex"?i:le(i)}function Ve(e){const{key:n="public",name:s="Public Client"}=e;return he({...e,key:n,name:s,type:"publicClient"}).extend(xe)}function Be(e){const{r:n,s}=ye.Signature.fromCompact(e.slice(2,130)),t=+`0x${e.slice(130)}`,[r,i]=(()=>{if(t===0||t===1)return[void 0,t];if(t===27)return[BigInt(t),0];if(t===28)return[BigInt(t),1];throw new Error("Invalid yParityOrV value")})();return typeof r<"u"?{r:a(n,{size:32}),s:a(s,{size:32}),v:r,yParity:i}:{r:a(n,{size:32}),s:a(s,{size:32}),yParity:i}}export{A as a,me as b,pe as c,ge as d,Ge as e,be as f,ve as g,Ve as h,Ae as i,v as j,Ce as k,Me as n,Be as p,He as s,ke as z};
