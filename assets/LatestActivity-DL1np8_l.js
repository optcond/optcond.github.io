import{j as e}from"./query-Df61bAsc.js";import{r as w}from"./react-uYZGv8Ap.js";import{C as d,B as i,S as x,b as f}from"./index-BIBNZVrl.js";import{T as y,a as C,b as h,c as p}from"./tabs-DBAGUye8.js";import{H as _,e as A,E as T}from"./lucide-DR8pGVsZ.js";import"./recharts-wdVATIY2.js";import"./supabase-CskpBK-R.js";const g=t=>t.length<=12?t:`${t.slice(0,6)}...${t.slice(-4)}`,u=({type:t,data:s,txHash:r,renderBorrowers:n})=>e.jsxs("div",{className:"p-4 rounded-lg bg-card/30 border border-card-border/40 hover:bg-card/50 transition-smooth",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-semibold capitalize",children:t}),t==="liquidation"&&e.jsx("span",{className:"ml-2 text-xs text-muted-foreground font-mono",children:g(s.borrower)})]}),e.jsxs(i,{variant:"outline",className:"text-xs font-mono",children:["#",s.block_number.toLocaleString()]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-2 mb-2 text-sm sm:grid-cols-2",children:t==="liquidation"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Debt:"})," ",e.jsxs("span",{className:"font-medium",children:[s.debt.toFixed(2)," MUSD"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Collateral:"})," ",e.jsxs("span",{className:"font-medium",children:[s.collateral.toFixed(4)," BTC"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Attempted:"})," ",e.jsxs("span",{className:"font-medium",children:[s.attempted_amount.toFixed(2)," MUSD"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Actual:"})," ",e.jsxs("span",{className:"font-medium",children:[s.actual_amount.toFixed(2)," MUSD"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Collateral:"})," ",e.jsxs("span",{className:"font-medium",children:[s.collateral_sent.toFixed(4)," BTC"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Fee:"})," ",e.jsxs("span",{className:"font-medium",children:[s.collateral_fee.toFixed(4)," BTC"]})]})]})}),t==="redemption"&&n&&Array.isArray(s.affected_borrowers)&&s.affected_borrowers.length>0&&e.jsx("div",{className:"mb-3 text-xs",children:n(s.affected_borrowers)}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:new Date(s.block_timestamp).toLocaleString()}),e.jsxs(f,{variant:"ghost",size:"sm",className:"h-7 gap-1",onClick:()=>window.open(`https://explorer.mezo.org/tx/${r}`,"_blank"),children:[e.jsx(T,{className:"h-3 w-3"}),"View"]})]})]}),j=({type:t})=>e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(A,{className:"h-12 w-12 text-muted-foreground/40 mb-3"}),e.jsxs("p",{className:"text-muted-foreground",children:["No recent ",t,". Confirm the indexer is running."]})]}),E=({liquidations:t,redemptions:s,isLoading:r})=>{const[n,N]=w.useState("liquidations"),b=a=>{if(a.length===0)return null;const m=a.slice(0,4),o=a.length-m.length;return e.jsxs("div",{className:"flex flex-wrap items-center gap-1 text-muted-foreground",children:[e.jsx("span",{className:"text-[11px] uppercase tracking-wide font-semibold",children:"Borrowers:"}),m.map((l,v)=>e.jsx(f,{variant:"link",className:"h-auto p-0 text-xs font-mono",onClick:()=>window.open(`https://explorer.mezo.org/address/${l}`,"_blank"),children:g(l.toLowerCase())},`${l}-${v}`)),o>0&&e.jsxs("span",{className:"text-[11px] text-muted-foreground",children:["+",o," more"]})]})};return r?e.jsxs(d,{className:"glass-card p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Latest Activity"}),e.jsx("div",{className:"h-64 bg-muted/20 animate-pulse rounded-xl"})]}):e.jsx(d,{className:"glass-card p-6",children:e.jsxs(y,{value:n,onValueChange:N,children:[e.jsxs("div",{className:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2 text-primary",children:[e.jsx(_,{className:"h-5 w-5 text-primary"}),"Latest Activity"]}),e.jsxs(C,{className:"flex w-full flex-wrap gap-2 bg-transparent p-0 sm:w-auto sm:flex-nowrap sm:bg-muted/10 sm:p-1",children:[e.jsxs(h,{value:"liquidations",className:"flex-1 min-w-[140px] sm:flex-none",children:["Liquidations",e.jsx(i,{variant:"secondary",className:"ml-2",children:t.length})]}),e.jsxs(h,{value:"redemptions",className:"flex-1 min-w-[140px] sm:flex-none",children:["Redemptions",e.jsx(i,{variant:"secondary",className:"ml-2",children:s.length})]})]})]}),e.jsx(p,{value:"liquidations",children:t.length===0?e.jsx(j,{type:"liquidations"}):e.jsx(x,{className:"h-[360px] pr-2 md:pr-4",children:e.jsx("div",{className:"space-y-3",children:t.map(a=>e.jsx(u,{type:"liquidation",data:a,txHash:a.tx_hash},a.id))})})}),e.jsx(p,{value:"redemptions",children:s.length===0?e.jsx(j,{type:"redemptions"}):e.jsx(x,{className:"h-[360px] pr-2 md:pr-4",children:e.jsx("div",{className:"space-y-3",children:s.map(a=>e.jsx(u,{type:"redemption",data:a,txHash:a.tx_hash,renderBorrowers:c=>b(c)},a.id))})})})]})})};export{E as LatestActivity};
