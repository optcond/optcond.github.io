import{j as r}from"./query-CpGXJd7o.js";import{r as i}from"./react-uYZGv8Ap.js";import{D as E,F as ve,v as ge,P as A,J as O,z as P,I as C,K as Se,L as we,d as re,C as J,a as U,f as S,B as te}from"./index-CCmhvFni.js";import{T as je,a as Ce,b as K,c as G}from"./tabs-DXQLdHx3.js";import{H as Pe,d as ye,E as Ne}from"./lucide-DpEOl3rZ.js";import"./supabase-CskpBK-R.js";import"./recharts-CblCIUsG.js";function Ee(e,t){return i.useReducer((o,l)=>t[o][l]??o,e)}var Y="ScrollArea",[oe]=ge(Y),[Re,v]=oe(Y),ne=i.forwardRef((e,t)=>{const{__scopeScrollArea:o,type:l="hover",dir:n,scrollHideDelay:a=600,...s}=e,[c,d]=i.useState(null),[u,m]=i.useState(null),[f,h]=i.useState(null),[x,b]=i.useState(null),[R,I]=i.useState(null),[j,D]=i.useState(0),[M,_]=i.useState(0),[L,T]=i.useState(!1),[H,z]=i.useState(!1),p=E(t,y=>d(y)),g=ve(n);return r.jsx(Re,{scope:o,type:l,dir:g,scrollHideDelay:a,scrollArea:c,viewport:u,onViewportChange:m,content:f,onContentChange:h,scrollbarX:x,onScrollbarXChange:b,scrollbarXEnabled:L,onScrollbarXEnabledChange:T,scrollbarY:R,onScrollbarYChange:I,scrollbarYEnabled:H,onScrollbarYEnabledChange:z,onCornerWidthChange:D,onCornerHeightChange:_,children:r.jsx(A.div,{dir:g,...s,ref:p,style:{position:"relative","--radix-scroll-area-corner-width":j+"px","--radix-scroll-area-corner-height":M+"px",...e.style}})})});ne.displayName=Y;var le="ScrollAreaViewport",se=i.forwardRef((e,t)=>{const{__scopeScrollArea:o,children:l,nonce:n,...a}=e,s=v(le,o),c=i.useRef(null),d=E(t,c,s.onViewportChange);return r.jsxs(r.Fragment,{children:[r.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),r.jsx(A.div,{"data-radix-scroll-area-viewport":"",...a,ref:d,style:{overflowX:s.scrollbarXEnabled?"scroll":"hidden",overflowY:s.scrollbarYEnabled?"scroll":"hidden",...e.style},children:r.jsx("div",{ref:s.onContentChange,style:{minWidth:"100%",display:"table"},children:l})})]})});se.displayName=le;var w="ScrollAreaScrollbar",V=i.forwardRef((e,t)=>{const{forceMount:o,...l}=e,n=v(w,e.__scopeScrollArea),{onScrollbarXEnabledChange:a,onScrollbarYEnabledChange:s}=n,c=e.orientation==="horizontal";return i.useEffect(()=>(c?a(!0):s(!0),()=>{c?a(!1):s(!1)}),[c,a,s]),n.type==="hover"?r.jsx(Te,{...l,ref:t,forceMount:o}):n.type==="scroll"?r.jsx(Ae,{...l,ref:t,forceMount:o}):n.type==="auto"?r.jsx(ae,{...l,ref:t,forceMount:o}):n.type==="always"?r.jsx($,{...l,ref:t}):null});V.displayName=w;var Te=i.forwardRef((e,t)=>{const{forceMount:o,...l}=e,n=v(w,e.__scopeScrollArea),[a,s]=i.useState(!1);return i.useEffect(()=>{const c=n.scrollArea;let d=0;if(c){const u=()=>{window.clearTimeout(d),s(!0)},m=()=>{d=window.setTimeout(()=>s(!1),n.scrollHideDelay)};return c.addEventListener("pointerenter",u),c.addEventListener("pointerleave",m),()=>{window.clearTimeout(d),c.removeEventListener("pointerenter",u),c.removeEventListener("pointerleave",m)}}},[n.scrollArea,n.scrollHideDelay]),r.jsx(O,{present:o||a,children:r.jsx(ae,{"data-state":a?"visible":"hidden",...l,ref:t})})}),Ae=i.forwardRef((e,t)=>{const{forceMount:o,...l}=e,n=v(w,e.__scopeScrollArea),a=e.orientation==="horizontal",s=k(()=>d("SCROLL_END"),100),[c,d]=Ee("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return i.useEffect(()=>{if(c==="idle"){const u=window.setTimeout(()=>d("HIDE"),n.scrollHideDelay);return()=>window.clearTimeout(u)}},[c,n.scrollHideDelay,d]),i.useEffect(()=>{const u=n.viewport,m=a?"scrollLeft":"scrollTop";if(u){let f=u[m];const h=()=>{const x=u[m];f!==x&&(d("SCROLL"),s()),f=x};return u.addEventListener("scroll",h),()=>u.removeEventListener("scroll",h)}},[n.viewport,a,d,s]),r.jsx(O,{present:o||c!=="hidden",children:r.jsx($,{"data-state":c==="hidden"?"hidden":"visible",...l,ref:t,onPointerEnter:P(e.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:P(e.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),ae=i.forwardRef((e,t)=>{const o=v(w,e.__scopeScrollArea),{forceMount:l,...n}=e,[a,s]=i.useState(!1),c=e.orientation==="horizontal",d=k(()=>{if(o.viewport){const u=o.viewport.offsetWidth<o.viewport.scrollWidth,m=o.viewport.offsetHeight<o.viewport.scrollHeight;s(c?u:m)}},10);return N(o.viewport,d),N(o.content,d),r.jsx(O,{present:l||a,children:r.jsx($,{"data-state":a?"visible":"hidden",...n,ref:t})})}),$=i.forwardRef((e,t)=>{const{orientation:o="vertical",...l}=e,n=v(w,e.__scopeScrollArea),a=i.useRef(null),s=i.useRef(0),[c,d]=i.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=ue(c.viewport,c.content),m={...l,sizes:c,onSizesChange:d,hasThumb:u>0&&u<1,onThumbChange:h=>a.current=h,onThumbPointerUp:()=>s.current=0,onThumbPointerDown:h=>s.current=h};function f(h,x){return Fe(h,s.current,c,x)}return o==="horizontal"?r.jsx(De,{...m,ref:t,onThumbPositionChange:()=>{if(n.viewport&&a.current){const h=n.viewport.scrollLeft,x=Q(h,c,n.dir);a.current.style.transform=`translate3d(${x}px, 0, 0)`}},onWheelScroll:h=>{n.viewport&&(n.viewport.scrollLeft=h)},onDragScroll:h=>{n.viewport&&(n.viewport.scrollLeft=f(h,n.dir))}}):o==="vertical"?r.jsx(_e,{...m,ref:t,onThumbPositionChange:()=>{if(n.viewport&&a.current){const h=n.viewport.scrollTop,x=Q(h,c);a.current.style.transform=`translate3d(0, ${x}px, 0)`}},onWheelScroll:h=>{n.viewport&&(n.viewport.scrollTop=h)},onDragScroll:h=>{n.viewport&&(n.viewport.scrollTop=f(h))}}):null}),De=i.forwardRef((e,t)=>{const{sizes:o,onSizesChange:l,...n}=e,a=v(w,e.__scopeScrollArea),[s,c]=i.useState(),d=i.useRef(null),u=E(t,d,a.onScrollbarXChange);return i.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),r.jsx(ce,{"data-orientation":"horizontal",...n,ref:u,sizes:o,style:{bottom:0,left:a.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:a.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":B(o)+"px",...e.style},onThumbPointerDown:m=>e.onThumbPointerDown(m.x),onDragScroll:m=>e.onDragScroll(m.x),onWheelScroll:(m,f)=>{if(a.viewport){const h=a.viewport.scrollLeft+m.deltaX;e.onWheelScroll(h),fe(h,f)&&m.preventDefault()}},onResize:()=>{d.current&&a.viewport&&s&&l({content:a.viewport.scrollWidth,viewport:a.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:W(s.paddingLeft),paddingEnd:W(s.paddingRight)}})}})}),_e=i.forwardRef((e,t)=>{const{sizes:o,onSizesChange:l,...n}=e,a=v(w,e.__scopeScrollArea),[s,c]=i.useState(),d=i.useRef(null),u=E(t,d,a.onScrollbarYChange);return i.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),r.jsx(ce,{"data-orientation":"vertical",...n,ref:u,sizes:o,style:{top:0,right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":B(o)+"px",...e.style},onThumbPointerDown:m=>e.onThumbPointerDown(m.y),onDragScroll:m=>e.onDragScroll(m.y),onWheelScroll:(m,f)=>{if(a.viewport){const h=a.viewport.scrollTop+m.deltaY;e.onWheelScroll(h),fe(h,f)&&m.preventDefault()}},onResize:()=>{d.current&&a.viewport&&s&&l({content:a.viewport.scrollHeight,viewport:a.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:W(s.paddingTop),paddingEnd:W(s.paddingBottom)}})}})}),[Le,ie]=oe(w),ce=i.forwardRef((e,t)=>{const{__scopeScrollArea:o,sizes:l,hasThumb:n,onThumbChange:a,onThumbPointerUp:s,onThumbPointerDown:c,onThumbPositionChange:d,onDragScroll:u,onWheelScroll:m,onResize:f,...h}=e,x=v(w,o),[b,R]=i.useState(null),I=E(t,p=>R(p)),j=i.useRef(null),D=i.useRef(""),M=x.viewport,_=l.content-l.viewport,L=C(m),T=C(d),H=k(f,10);function z(p){if(j.current){const g=p.clientX-j.current.left,y=p.clientY-j.current.top;u({x:g,y})}}return i.useEffect(()=>{const p=g=>{const y=g.target;(b==null?void 0:b.contains(y))&&L(g,_)};return document.addEventListener("wheel",p,{passive:!1}),()=>document.removeEventListener("wheel",p,{passive:!1})},[M,b,_,L]),i.useEffect(T,[l,T]),N(b,H),N(x.content,H),r.jsx(Le,{scope:o,scrollbar:b,hasThumb:n,onThumbChange:C(a),onThumbPointerUp:C(s),onThumbPositionChange:T,onThumbPointerDown:C(c),children:r.jsx(A.div,{...h,ref:I,style:{position:"absolute",...h.style},onPointerDown:P(e.onPointerDown,p=>{p.button===0&&(p.target.setPointerCapture(p.pointerId),j.current=b.getBoundingClientRect(),D.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",x.viewport&&(x.viewport.style.scrollBehavior="auto"),z(p))}),onPointerMove:P(e.onPointerMove,z),onPointerUp:P(e.onPointerUp,p=>{const g=p.target;g.hasPointerCapture(p.pointerId)&&g.releasePointerCapture(p.pointerId),document.body.style.webkitUserSelect=D.current,x.viewport&&(x.viewport.style.scrollBehavior=""),j.current=null})})})}),F="ScrollAreaThumb",de=i.forwardRef((e,t)=>{const{forceMount:o,...l}=e,n=ie(F,e.__scopeScrollArea);return r.jsx(O,{present:o||n.hasThumb,children:r.jsx(He,{ref:t,...l})})}),He=i.forwardRef((e,t)=>{const{__scopeScrollArea:o,style:l,...n}=e,a=v(F,o),s=ie(F,o),{onThumbPositionChange:c}=s,d=E(t,f=>s.onThumbChange(f)),u=i.useRef(void 0),m=k(()=>{u.current&&(u.current(),u.current=void 0)},100);return i.useEffect(()=>{const f=a.viewport;if(f){const h=()=>{if(m(),!u.current){const x=We(f,c);u.current=x,c()}};return c(),f.addEventListener("scroll",h),()=>f.removeEventListener("scroll",h)}},[a.viewport,m,c]),r.jsx(A.div,{"data-state":s.hasThumb?"visible":"hidden",...n,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...l},onPointerDownCapture:P(e.onPointerDownCapture,f=>{const x=f.target.getBoundingClientRect(),b=f.clientX-x.left,R=f.clientY-x.top;s.onThumbPointerDown({x:b,y:R})}),onPointerUp:P(e.onPointerUp,s.onThumbPointerUp)})});de.displayName=F;var q="ScrollAreaCorner",me=i.forwardRef((e,t)=>{const o=v(q,e.__scopeScrollArea),l=!!(o.scrollbarX&&o.scrollbarY);return o.type!=="scroll"&&l?r.jsx(ze,{...e,ref:t}):null});me.displayName=q;var ze=i.forwardRef((e,t)=>{const{__scopeScrollArea:o,...l}=e,n=v(q,o),[a,s]=i.useState(0),[c,d]=i.useState(0),u=!!(a&&c);return N(n.scrollbarX,()=>{var f;const m=((f=n.scrollbarX)==null?void 0:f.offsetHeight)||0;n.onCornerHeightChange(m),d(m)}),N(n.scrollbarY,()=>{var f;const m=((f=n.scrollbarY)==null?void 0:f.offsetWidth)||0;n.onCornerWidthChange(m),s(m)}),u?r.jsx(A.div,{...l,ref:t,style:{width:a,height:c,position:"absolute",right:n.dir==="ltr"?0:void 0,left:n.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function W(e){return e?parseInt(e,10):0}function ue(e,t){const o=e/t;return isNaN(o)?0:o}function B(e){const t=ue(e.viewport,e.content),o=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,l=(e.scrollbar.size-o)*t;return Math.max(l,18)}function Fe(e,t,o,l="ltr"){const n=B(o),a=n/2,s=t||a,c=n-s,d=o.scrollbar.paddingStart+s,u=o.scrollbar.size-o.scrollbar.paddingEnd-c,m=o.content-o.viewport,f=l==="ltr"?[0,m]:[m*-1,0];return he([d,u],f)(e)}function Q(e,t,o="ltr"){const l=B(t),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,a=t.scrollbar.size-n,s=t.content-t.viewport,c=a-l,d=o==="ltr"?[0,s]:[s*-1,0],u=we(e,d);return he([0,s],[0,c])(u)}function he(e,t){return o=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const l=(t[1]-t[0])/(e[1]-e[0]);return t[0]+l*(o-e[0])}}function fe(e,t){return e>0&&e<t}var We=(e,t=()=>{})=>{let o={left:e.scrollLeft,top:e.scrollTop},l=0;return function n(){const a={left:e.scrollLeft,top:e.scrollTop},s=o.left!==a.left,c=o.top!==a.top;(s||c)&&t(),o=a,l=window.requestAnimationFrame(n)}(),()=>window.cancelAnimationFrame(l)};function k(e,t){const o=C(e),l=i.useRef(0);return i.useEffect(()=>()=>window.clearTimeout(l.current),[]),i.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(o,t)},[o,t])}function N(e,t){const o=C(t);Se(()=>{let l=0;if(e){const n=new ResizeObserver(()=>{cancelAnimationFrame(l),l=window.requestAnimationFrame(o)});return n.observe(e),()=>{window.cancelAnimationFrame(l),n.unobserve(e)}}},[e,o])}var xe=ne,Oe=se,Be=me;const X=i.forwardRef(({className:e,children:t,...o},l)=>r.jsxs(xe,{ref:l,className:re("relative overflow-hidden",e),...o,children:[r.jsx(Oe,{className:"h-full w-full rounded-[inherit]",children:t}),r.jsx(pe,{}),r.jsx(Be,{})]}));X.displayName=xe.displayName;const pe=i.forwardRef(({className:e,orientation:t="vertical",...o},l)=>r.jsx(V,{ref:l,orientation:t,className:re("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...o,children:r.jsx(de,{className:"relative flex-1 rounded-full bg-border"})}));pe.displayName=V.displayName;const be=e=>e.length<=12?e:`${e.slice(0,6)}...${e.slice(-4)}`,Z=({type:e,data:t,txHash:o,renderBorrowers:l})=>r.jsxs("div",{className:"p-4 rounded-lg bg-card/30 border border-card-border/40 hover:bg-card/50 transition-smooth",children:[r.jsxs("div",{className:"flex items-start justify-between mb-2",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-semibold capitalize",children:e}),e==="liquidation"&&r.jsx("span",{className:"ml-2 text-xs text-muted-foreground font-mono",children:be(t.borrower)})]}),r.jsxs(U,{variant:"outline",className:"text-xs font-mono",children:["#",S(t.block_number)]})]}),r.jsx("div",{className:"grid grid-cols-1 gap-2 mb-2 text-sm sm:grid-cols-2",children:e==="liquidation"?r.jsxs(r.Fragment,{children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"Debt:"})," ",r.jsxs("span",{className:"font-medium",children:[S(t.debt,{minimumFractionDigits:2,maximumFractionDigits:2})," ","MUSD"]})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"Collateral:"})," ",r.jsxs("span",{className:"font-medium",children:[S(t.collateral,{minimumFractionDigits:4,maximumFractionDigits:4})," ","BTC"]})]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"Attempted:"})," ",r.jsxs("span",{className:"font-medium",children:[S(t.attempted_amount,{minimumFractionDigits:2,maximumFractionDigits:2})," ","MUSD"]})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"Actual:"})," ",r.jsxs("span",{className:"font-medium",children:[S(t.actual_amount,{minimumFractionDigits:2,maximumFractionDigits:2})," ","MUSD"]})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"Collateral:"})," ",r.jsxs("span",{className:"font-medium",children:[S(t.collateral_sent,{minimumFractionDigits:4,maximumFractionDigits:4})," ","BTC"]})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-muted-foreground",children:"Fee:"})," ",r.jsxs("span",{className:"font-medium",children:[S(t.collateral_fee,{minimumFractionDigits:4,maximumFractionDigits:4})," ","BTC"]})]})]})}),e==="redemption"&&l&&Array.isArray(t.affected_borrowers)&&t.affected_borrowers.length>0&&r.jsx("div",{className:"mb-3 text-xs",children:l(t.affected_borrowers)}),r.jsxs("div",{className:"flex items-center justify-between text-xs",children:[r.jsx("span",{className:"text-muted-foreground",children:new Date(t.block_timestamp).toLocaleString()}),r.jsxs(te,{variant:"ghost",size:"sm",className:"h-7 gap-1",onClick:()=>window.open(`https://explorer.mezo.org/tx/${o}`,"_blank"),children:[r.jsx(Ne,{className:"h-3 w-3"}),"View"]})]})]}),ee=({type:e})=>r.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[r.jsx(ye,{className:"h-12 w-12 text-muted-foreground/40 mb-3"}),r.jsxs("p",{className:"text-muted-foreground",children:["No recent ",e,". Confirm the indexer is running."]})]}),qe=({liquidations:e,redemptions:t,isLoading:o})=>{const[l,n]=i.useState("liquidations"),a=s=>{if(s.length===0)return null;const d=s.slice(0,4),u=s.length-d.length;return r.jsxs("div",{className:"flex flex-wrap items-center gap-1 text-muted-foreground",children:[r.jsx("span",{className:"text-[11px] uppercase tracking-wide font-semibold",children:"Borrowers:"}),d.map((m,f)=>r.jsx(te,{variant:"link",className:"h-auto p-0 text-xs font-mono",onClick:()=>window.open(`https://explorer.mezo.org/address/${m}`,"_blank"),children:be(m.toLowerCase())},`${m}-${f}`)),u>0&&r.jsxs("span",{className:"text-[11px] text-muted-foreground",children:["+",S(u)," more"]})]})};return o?r.jsxs(J,{className:"glass-card p-6",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Latest Activity"}),r.jsx("div",{className:"h-64 bg-muted/20 animate-pulse rounded-xl"})]}):r.jsx(J,{className:"glass-card p-6",children:r.jsxs(je,{value:l,onValueChange:n,children:[r.jsxs("div",{className:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[r.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2 text-primary",children:[r.jsx(Pe,{className:"h-5 w-5 text-primary"}),"Latest Activity"]}),r.jsxs(Ce,{className:"flex w-full flex-wrap gap-2 bg-transparent p-0 sm:w-auto sm:flex-nowrap sm:bg-muted/10 sm:p-1",children:[r.jsxs(K,{value:"liquidations",className:"flex-1 min-w-[140px] sm:flex-none",children:["Liquidations",r.jsx(U,{variant:"secondary",className:"ml-2",children:S(e.length)})]}),r.jsxs(K,{value:"redemptions",className:"flex-1 min-w-[140px] sm:flex-none",children:["Redemptions",r.jsx(U,{variant:"secondary",className:"ml-2",children:S(t.length)})]})]})]}),r.jsx(G,{value:"liquidations",children:e.length===0?r.jsx(ee,{type:"liquidations"}):r.jsx(X,{className:"h-[360px] pr-2 md:pr-4",children:r.jsx("div",{className:"space-y-3",children:e.map(s=>r.jsx(Z,{type:"liquidation",data:s,txHash:s.tx_hash},s.id))})})}),r.jsx(G,{value:"redemptions",children:t.length===0?r.jsx(ee,{type:"redemptions"}):r.jsx(X,{className:"h-[360px] pr-2 md:pr-4",children:r.jsx("div",{className:"space-y-3",children:t.map(s=>r.jsx(Z,{type:"redemption",data:s,txHash:s.tx_hash,renderBorrowers:c=>a(c)},s.id))})})})]})})};export{qe as LatestActivity};
