import{j as e}from"./query-CpGXJd7o.js";import{r as y}from"./react-uYZGv8Ap.js";import{C as x,b as m,f as i,S as h,B as g}from"./index-C2lAhJGr.js";import{T as D,a as F,b as u,c as p}from"./tabs-D3mXPogi.js";import{H as C,h as _,E as A}from"./lucide-B3uNCNrP.js";import"./supabase-CskpBK-R.js";import"./recharts-CblCIUsG.js";const N=t=>t.length<=12?t:`${t.slice(0,6)}...${t.slice(-4)}`,j=({type:t,data:s,txHash:r,renderBorrowers:n})=>e.jsxs("div",{className:"p-4 rounded-lg bg-card/30 border border-card-border/40 hover:bg-card/50 transition-smooth",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-semibold capitalize",children:t}),t==="liquidation"&&e.jsx("span",{className:"ml-2 text-xs text-muted-foreground font-mono",children:N(s.borrower)})]}),e.jsxs(m,{variant:"outline",className:"text-xs font-mono",children:["#",i(s.block_number)]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-2 mb-2 text-sm sm:grid-cols-2",children:t==="liquidation"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Debt:"})," ",e.jsxs("span",{className:"font-medium",children:[i(s.debt,{minimumFractionDigits:2,maximumFractionDigits:2})," ","MUSD"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Collateral:"})," ",e.jsxs("span",{className:"font-medium",children:[i(s.collateral,{minimumFractionDigits:4,maximumFractionDigits:4})," ","BTC"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Attempted:"})," ",e.jsxs("span",{className:"font-medium",children:[i(s.attempted_amount,{minimumFractionDigits:2,maximumFractionDigits:2})," ","MUSD"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Actual:"})," ",e.jsxs("span",{className:"font-medium",children:[i(s.actual_amount,{minimumFractionDigits:2,maximumFractionDigits:2})," ","MUSD"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Collateral:"})," ",e.jsxs("span",{className:"font-medium",children:[i(s.collateral_sent,{minimumFractionDigits:4,maximumFractionDigits:4})," ","BTC"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Fee:"})," ",e.jsxs("span",{className:"font-medium",children:[i(s.collateral_fee,{minimumFractionDigits:4,maximumFractionDigits:4})," ","BTC"]})]})]})}),t==="redemption"&&n&&Array.isArray(s.affected_borrowers)&&s.affected_borrowers.length>0&&e.jsx("div",{className:"mb-3 text-xs",children:n(s.affected_borrowers)}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:new Date(s.block_timestamp).toLocaleString()}),e.jsxs(g,{variant:"ghost",size:"sm",className:"h-7 gap-1",onClick:()=>window.open(`https://explorer.mezo.org/tx/${r}`,"_blank"),children:[e.jsx(A,{className:"h-3 w-3"}),"View"]})]})]}),f=({type:t})=>e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(_,{className:"h-12 w-12 text-muted-foreground/40 mb-3"}),e.jsxs("p",{className:"text-muted-foreground",children:["No recent ",t,". Confirm the indexer is running."]})]}),q=({liquidations:t,redemptions:s,isLoading:r})=>{const[n,b]=y.useState("liquidations"),v=a=>{if(a.length===0)return null;const o=a.slice(0,4),d=a.length-o.length;return e.jsxs("div",{className:"flex flex-wrap items-center gap-1 text-muted-foreground",children:[e.jsx("span",{className:"text-[11px] uppercase tracking-wide font-semibold",children:"Borrowers:"}),o.map((l,w)=>e.jsx(g,{variant:"link",className:"h-auto p-0 text-xs font-mono",onClick:()=>window.open(`https://explorer.mezo.org/address/${l}`,"_blank"),children:N(l.toLowerCase())},`${l}-${w}`)),d>0&&e.jsxs("span",{className:"text-[11px] text-muted-foreground",children:["+",i(d)," more"]})]})};return r?e.jsxs(x,{className:"glass-card p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Latest Activity"}),e.jsx("div",{className:"h-64 bg-muted/20 animate-pulse rounded-xl"})]}):e.jsx(x,{className:"glass-card p-6",children:e.jsxs(D,{value:n,onValueChange:b,children:[e.jsxs("div",{className:"mb-4 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2 text-primary",children:[e.jsx(C,{className:"h-5 w-5 text-primary"}),"Latest Activity"]}),e.jsxs(F,{className:"flex w-full flex-wrap gap-2 bg-transparent p-0 sm:w-auto sm:flex-nowrap sm:bg-muted/10 sm:p-1",children:[e.jsxs(u,{value:"liquidations",className:"flex-1 min-w-[140px] sm:flex-none",children:["Liquidations",e.jsx(m,{variant:"secondary",className:"ml-2",children:i(t.length)})]}),e.jsxs(u,{value:"redemptions",className:"flex-1 min-w-[140px] sm:flex-none",children:["Redemptions",e.jsx(m,{variant:"secondary",className:"ml-2",children:i(s.length)})]})]})]}),e.jsx(p,{value:"liquidations",children:t.length===0?e.jsx(f,{type:"liquidations"}):e.jsx(h,{className:"h-[360px] pr-2 md:pr-4",children:e.jsx("div",{className:"space-y-3",children:t.map(a=>e.jsx(j,{type:"liquidation",data:a,txHash:a.tx_hash},a.id))})})}),e.jsx(p,{value:"redemptions",children:s.length===0?e.jsx(f,{type:"redemptions"}):e.jsx(h,{className:"h-[360px] pr-2 md:pr-4",children:e.jsx("div",{className:"space-y-3",children:s.map(a=>e.jsx(j,{type:"redemption",data:a,txHash:a.tx_hash,renderBorrowers:c=>v(c)},a.id))})})})]})})};export{q as LatestActivity};
