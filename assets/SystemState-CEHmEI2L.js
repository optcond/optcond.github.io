import{j as e}from"./query-CpGXJd7o.js";import{r as c}from"./react-uYZGv8Ap.js";import{C as m,f as g,B as j}from"./index-C2lAhJGr.js";import{L as C,U as v,C as y,a as w,G as N,A as S,b as T,c as R,d as k}from"./lucide-B3uNCNrP.js";import{R as D,L,C as F,X as $,Y as A,T as E,a as B}from"./recharts-CblCIUsG.js";import"./supabase-CskpBK-R.js";const x="mezo-chart-collapse-system-state",t=({label:a,value:o,subtitle:i,borderColor:d,icon:l})=>e.jsxs("div",{className:`relative w-full p-4 rounded-xl bg-card/40 border-l-4 ${d} min-w-[180px]`,children:[l&&e.jsx(l,{className:"absolute top-3 right-3 h-5 w-5 text-muted-foreground/40"}),e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:a}),e.jsx("div",{className:"text-2xl font-bold mb-1",children:o}),e.jsx("div",{className:"text-xs text-muted-foreground",children:i})]}),z=({tcr:a,tcrMinus10:o,tcrMinus20:i,totalCollateral:d,totalDebt:l,totalTroves:h,chartData:u,isLoading:b})=>{const[s,p]=c.useState(()=>{if(typeof window>"u")return!1;try{return window.localStorage.getItem(x)==="true"}catch{return!1}});c.useEffect(()=>{try{window.localStorage.setItem(x,String(s))}catch{}},[s]);const n=r=>r<1.2?"border-critical":r<1.6?"border-high":r<2?"border-elevated":"border-primary";return b?e.jsxs(m,{className:"glass-card p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"System State"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-24 bg-muted/20 animate-pulse rounded-xl"}),e.jsx("div",{className:"h-64 bg-muted/20 animate-pulse rounded-xl"})]})]}):e.jsxs(m,{className:"glass-card p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2 text-primary",children:[e.jsx(C,{className:"h-5 w-5 text-primary"}),"System State"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 mb-6 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsx(t,{label:"Total Troves",value:h.toLocaleString(),subtitle:"Active positions",borderColor:"border-primary",icon:v}),e.jsx(t,{label:"Total Collateral",value:`${d.toFixed(2)} BTC`,subtitle:"System-wide",borderColor:"border-primary",icon:y}),e.jsx(t,{label:"Total Debt",value:`${g(l,{minimumFractionDigits:2,maximumFractionDigits:2})} MUSD`,subtitle:"System-wide",borderColor:"border-primary",icon:w}),e.jsx(t,{label:"TCR",value:`${(a*100).toFixed(1)}%`,subtitle:"Total Collateral Ratio",borderColor:n(a),icon:N}),e.jsx(t,{label:"TCR -10%",value:`${(o*100).toFixed(1)}%`,subtitle:"10% price drop",borderColor:n(o),icon:S}),e.jsx(t,{label:"TCR -20%",value:`${(i*100).toFixed(1)}%`,subtitle:"20% price drop",borderColor:n(i),icon:T})]}),e.jsxs("div",{className:"bg-card/40 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-muted-foreground",children:"30-Day TCR History"}),e.jsxs(j,{type:"button",variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>p(r=>!r),children:[s?e.jsx(R,{className:"h-4 w-4"}):e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:s?"Show chart":"Hide chart"})]})]}),s?e.jsx("div",{className:"text-xs text-muted-foreground",children:"Chart hidden."}):e.jsx(D,{width:"100%",height:240,children:e.jsxs(L,{data:u,children:[e.jsx(F,{strokeDasharray:"3 3",stroke:"hsl(var(--border))",opacity:.3}),e.jsx($,{dataKey:"date",stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"},tickLine:!1}),e.jsx(A,{stroke:"hsl(var(--muted-foreground))",tick:{fill:"hsl(var(--muted-foreground))"},tickLine:!1,domain:[r=>r*.9,r=>r*1.1],tickFormatter:r=>r.toFixed(2)}),e.jsx(E,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px",color:"hsl(var(--foreground))"},formatter:(r,f)=>f==="tcr"?[`${(r*100).toFixed(2)}%`,"TCR"]:[`$${r.toLocaleString()}`,"BTC Price"]}),e.jsx(B,{type:"monotone",dataKey:"tcr",stroke:"hsl(var(--primary))",strokeWidth:2,dot:{fill:"hsl(var(--primary))",r:4},activeDot:{r:6}})]})})]})]})};export{z as SystemState};
